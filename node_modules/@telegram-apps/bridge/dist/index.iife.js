this.tapps=this.tapps||{};this.tapps.bridge=function(l){"use strict";function G(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(t,r)=>String.fromCharCode(parseInt(`0x${r}`)))).replace(/\+/g,"-").replace(/\//g,"_")}function ke(e){return decodeURIComponent(atob(e).replace(/-/g,"+").replace(/_/g,"/").split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join(""))}var k;function Pe(e){return{lang:(e==null?void 0:e.lang)??(k==null?void 0:k.lang),message:e==null?void 0:e.message,abortEarly:(e==null?void 0:e.abortEarly)??(k==null?void 0:k.abortEarly),abortPipeEarly:(e==null?void 0:e.abortPipeEarly)??(k==null?void 0:k.abortPipeEarly)}}var B;function Mt(e){return B==null?void 0:B.get(e)}var F;function Ot(e){return F==null?void 0:F.get(e)}var H;function It(e,t){var r;return(r=H==null?void 0:H.get(e))==null?void 0:r.get(t)}function qt(e){var r,n;const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&((n=(r=Object.getPrototypeOf(e))==null?void 0:r.constructor)==null?void 0:n.name))??"null":t}function M(e,t,r,n,s){const i=s&&"input"in s?s.input:r.value,a=(s==null?void 0:s.expected)??e.expects??null,o=(s==null?void 0:s.received)??qt(i),u={kind:e.kind,type:e.type,input:i,expected:a,received:o,message:`Invalid ${t}: ${a?`Expected ${a} but r`:"R"}eceived ${o}`,requirement:e.requirement,path:s==null?void 0:s.path,issues:s==null?void 0:s.issues,lang:n.lang,abortEarly:n.abortEarly,abortPipeEarly:n.abortPipeEarly},c=e.kind==="schema",p=(s==null?void 0:s.message)??e.message??It(e.reference,u.lang)??(c?Ot(u.lang):null)??n.message??Mt(u.lang);p!==void 0&&(u.message=typeof p=="function"?p(u):p),c&&(r.typed=!1),r.issues?r.issues.push(u):r.issues=[u]}function E(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},Pe())}}}function Lt(e,t){return Object.hasOwn(e,t)&&t!=="__proto__"&&t!=="prototype"&&t!=="constructor"}var Rt=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function Ct(e,t,r){return typeof e.fallback=="function"?e.fallback(t,r):e.fallback}function K(e,t,r){return typeof e.default=="function"?e.default(t,r):e.default}function W(e,t){return!e["~run"]({value:t},{abortEarly:!0}).issues}function $e(){return{kind:"schema",type:"any",reference:$e,expects:"any",async:!1,get"~standard"(){return E(this)},"~run"(e){return e.typed=!0,e}}}function Y(e){return{kind:"schema",type:"boolean",reference:Y,expects:"boolean",async:!1,message:e,get"~standard"(){return E(this)},"~run"(t,r){return typeof t.value=="boolean"?t.typed=!0:M(this,"type",t,r),t}}}function Q(e){return{kind:"schema",type:"function",reference:Q,expects:"Function",async:!1,message:e,get"~standard"(){return E(this)},"~run"(t,r){return typeof t.value=="function"?t.typed=!0:M(this,"type",t,r),t}}}function w(e,t){return{kind:"schema",type:"loose_object",reference:w,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return E(this)},"~run"(r,n){var i;const s=r.value;if(s&&typeof s=="object"){r.typed=!0,r.value={};for(const a in this.entries){const o=this.entries[a];if(a in s||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){const u=a in s?s[a]:K(o),c=o["~run"]({value:u},n);if(c.issues){const p={type:"object",origin:"value",input:s,key:a,value:u};for(const f of c.issues)f.path?f.path.unshift(p):f.path=[p],(i=r.issues)==null||i.push(f);if(r.issues||(r.issues=c.issues),n.abortEarly){r.typed=!1;break}}c.typed||(r.typed=!1),r.value[a]=c.value}else if(o.fallback!==void 0)r.value[a]=Ct(o);else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(M(this,"key",r,n,{input:void 0,expected:`"${a}"`,path:[{type:"object",origin:"key",input:s,key:a,value:s[a]}]}),n.abortEarly))break}if(!r.issues||!n.abortEarly)for(const a in s)Lt(s,a)&&!(a in this.entries)&&(r.value[a]=s[a])}else M(this,"type",r,n);return r}}}function C(e,t){return{kind:"schema",type:"nullish",reference:C,expects:`(${e.expects} | null | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return E(this)},"~run"(r,n){return(r.value===null||r.value===void 0)&&(this.default!==void 0&&(r.value=K(this,r,n)),r.value===null||r.value===void 0)?(r.typed=!0,r):this.wrapped["~run"](r,n)}}}function Z(e){return{kind:"schema",type:"number",reference:Z,expects:"number",async:!1,message:e,get"~standard"(){return E(this)},"~run"(t,r){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:M(this,"type",t,r),t}}}function X(e,t){return{kind:"schema",type:"optional",reference:X,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return E(this)},"~run"(r,n){return r.value===void 0&&(this.default!==void 0&&(r.value=K(this,r,n)),r.value===void 0)?(r.typed=!0,r):this.wrapped["~run"](r,n)}}}function $(e){return{kind:"schema",type:"string",reference:$,expects:"string",async:!1,message:e,get"~standard"(){return E(this)},"~run"(t,r){return typeof t.value=="string"?t.typed=!0:M(this,"type",t,r),t}}}function Se(){return{kind:"schema",type:"unknown",reference:Se,expects:"unknown",async:!1,get"~standard"(){return E(this)},"~run"(e){return e.typed=!0,e}}}function V(e,t,r){const n=e["~run"]({value:t},Pe(r));if(n.issues)throw new Rt(n.issues);return n.value}function je(...e){return{...e[0],pipe:e,get"~standard"(){return E(this)},"~run"(t,r){for(const n of e)if(n.kind!=="metadata"){if(t.issues&&(n.kind==="schema"||n.kind==="transformation")){t.typed=!1;break}(!t.issues||!r.abortEarly&&!r.abortPipeEarly)&&(t=n["~run"](t,r))}return t}}}function ee(e){return W(w({TelegramWebviewProxy:w({postEvent:Q()})}),e)}function te(){try{return window.self!==window.top}catch{return!0}}var Ut=Object.defineProperty,Wt=(e,t,r)=>t in e?Ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,re=(e,t,r)=>Wt(e,typeof t!="symbol"?t+"":t,r),Dt=Object.defineProperty,Nt=(e,t,r)=>t in e?Dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xt=(e,t,r)=>Nt(e,t+"",r);function Jt(e,t){return r=>r instanceof e&&r.type===t}function Ae(e,t){t||(t=[]);const r=Symbol(e);class n extends Error{constructor(...i){const a=typeof t=="function"?t(...i):typeof t=="string"?[t]:t||[];super(...a),xt(this,"type",r),this.name=e}}return Object.defineProperty(n,"name",{value:e}),[n,Jt(n,r)]}const[Te,zt]=Ae("CancelledError","Promise was canceled"),[Me,Gt]=Ae("TimeoutError",(e,t)=>[`Timeout reached: ${e}ms`,{cause:t}]),Oe=Symbol("Resolved");function Ie(e){return Array.isArray(e)&&e[0]===Oe}function Bt(e){return[Oe,e]}function qe(e,t){return e.reject=t.reject,e.abort=t.abort,e}class T extends Promise{constructor(t,r){let n,s;super((i,a)=>{let o,u;typeof t=="function"?(o=t,u=r):u=t;const c=[],p=y=>(...R)=>{const z=y(...R);return c.forEach(zr=>zr()),z},f=new AbortController,{signal:b}=f;s=y=>{!b.aborted&&f.abort(y)};const _=()=>b.reason,A=y=>{const R=()=>{y(_())};b.addEventListener("abort",R,!0);const z=()=>{b.removeEventListener("abort",R,!0)};return c.push(z),z},Jr=p(y=>{i(y),s(Bt(y))});n=p(y=>{a(y),s(y)}),u||(u={});const{abortSignal:L,rejectOnAbort:St=!0}=u;if(L)if(L.aborted){const{reason:y}=L;if(St)return n(y);s(y)}else{const y=()=>{s(L.reason)};L.addEventListener("abort",y),c.push(()=>{L.removeEventListener("abort",y)})}St&&A(a);const{timeout:we}=u;if(we){const y=setTimeout(()=>{s(new Me(we))},we);c.push(()=>{clearTimeout(y)})}const jt=()=>b.aborted,At=()=>Ie(_()),Tt=()=>{const y=_();return Ie(y)?y[1]:void 0};try{const y=o&&o(Jr,n,{abortReason:_,abortSignal:b,isAborted:jt,isResolved:At,onAborted:A,onResolved:R=>A(()=>{At()&&R(Tt())}),resolved:Tt,throwIfAborted(){if(jt())throw _()}});y instanceof Promise&&y.catch(n)}catch(y){n(y)}}),re(this,"abort"),re(this,"reject"),this.abort=s,this.reject=n}static fn(t,r){return new T(async(n,s,i)=>{try{n(await t(i))}catch(a){s(a)}},r)}static resolve(t){return this.fn(()=>t)}static reject(t){return new T((r,n)=>{n(t)})}cancel(){this.abort(new Te)}catch(t){return this.then(void 0,t)}finally(t){return qe(super.finally(t),this)}then(t,r){return qe(super.then(t,r),this)}}function Le(e,t){return e.resolve=t.resolve,e}let Ft=class Ee extends T{constructor(t,r){let n,s;typeof t=="function"?(n=t,s=r):s=t;let i;super((a,o,u)=>{i=a,n&&n(a,o,u)},s),re(this,"resolve"),this.resolve=i}static fn(t,r){return new Ee((n,s,i)=>{try{Promise.resolve(t(i)).then(n,s)}catch(a){s(a)}},r)}static resolve(t){return this.fn(()=>t)}static reject(t){return new Ee((r,n)=>{n(t)})}catch(t){return this.then(void 0,t)}finally(t){return Le(super.finally(t),this)}then(t,r){return Le(super.then(t,r),this)}};function Ht(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}function Kt(e){return Object.entries(e).reduce((t,[r,n])=>(t[Ht(r)]=n,t),{})}function ne(e){const t=Kt(e);for(const r in t){const n=t[r];n&&typeof n=="object"&&!(n instanceof Date)&&(t[r]=Array.isArray(n)?n.map(ne):ne(n))}return t}function Re(e){return`tapps/${e}`}function Ce(e,t){sessionStorage.setItem(Re(e),JSON.stringify(t))}function Yt(e){const t=sessionStorage.getItem(Re(e));try{return t?JSON.parse(t):void 0}catch{}}function Qt(...e){const t=e.flat(1);return[t.push.bind(t),()=>{t.forEach(r=>{r()})}]}function Ue(e,t){t||(t={});const{textColor:r,bgColor:n,shouldLog:s}=t,i=s===void 0?!0:s,a=typeof i=="boolean"?()=>i:i,o=(u,c,...p)=>{if(c||a()){const f="font-weight:bold;padding:0 5px;border-radius:100px",[b,_,A]={log:["#0089c3","white","INFO"],error:["#ff0000F0","white","ERR"],warn:["#D38E15","white","WARN"]}[u];console[u](`%c${A} ${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c %c${e}`,`${f};background-color:${b};color:${_}`,"",`${f};${r?`color:${r};`:""}${n?`background-color:${n}`:""}`,...p)}};return[["log","forceLog"],["warn","forceWarn"],["error","forceError"]].reduce((u,[c,p])=>(u[c]=o.bind(void 0,c,!1),u[p]=o.bind(void 0,c,!0),u),{})}function We(e){return{lang:(e==null?void 0:e.lang)??void 0,message:e==null?void 0:e.message,abortEarly:(e==null?void 0:e.abortEarly)??void 0,abortPipeEarly:(e==null?void 0:e.abortPipeEarly)??void 0}}function Gr(e){}function Br(e){}function Zt(e,t){var r;return(r=void 0)==null?void 0:r.get(t)}function Xt(e){var t,r;const n=typeof e;return n==="string"?`"${e}"`:n==="number"||n==="bigint"||n==="boolean"?`${e}`:n==="object"||n==="function"?(e&&((r=(t=Object.getPrototypeOf(e))==null?void 0:t.constructor)==null?void 0:r.name))??"null":n}function g(e,t,r,n,s){const i=s&&"input"in s?s.input:r.value,a=(s==null?void 0:s.expected)??e.expects??null,o=(s==null?void 0:s.received)??Xt(i),u={kind:e.kind,type:e.type,input:i,expected:a,received:o,message:`Invalid ${t}: ${a?`Expected ${a} but r`:"R"}eceived ${o}`,requirement:e.requirement,path:s==null?void 0:s.path,issues:s==null?void 0:s.issues,lang:n.lang,abortEarly:n.abortEarly,abortPipeEarly:n.abortPipeEarly},c=e.kind==="schema",p=(s==null?void 0:s.message)??e.message??Zt(e.reference,u.lang)??(c?(u.lang,void 0):null)??n.message??(u.lang,void 0);p&&(u.message=typeof p=="function"?p(u):p),c&&(r.typed=!1),r.issues?r.issues.push(u):r.issues=[u]}function v(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},We())}}}function De(e,t){return Object.hasOwn(e,t)&&t!=="__proto__"&&t!=="prototype"&&t!=="constructor"}function Vt(e,t){const r=[...new Set(e)];return r.length>1?`(${r.join(` ${t} `)})`:r[0]??"never"}var er=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function Ne(e,t){return{kind:"validation",type:"check",reference:Ne,async:!1,expects:null,requirement:e,message:t,"~run"(r,n){return r.typed&&!this.requirement(r.value)&&g(this,"input",r,n),r}}}function xe(e){return{kind:"validation",type:"integer",reference:xe,async:!1,expects:null,requirement:Number.isInteger,message:e,"~run"(t,r){return t.typed&&!this.requirement(t.value)&&g(this,"integer",t,r),t}}}function S(e){return{kind:"transformation",type:"transform",reference:S,async:!1,operation:e,"~run"(t){return t.value=this.operation(t.value),t}}}function Je(e,t,r){return typeof e.default=="function"?e.default(t,r):e.default}function tr(e,t){return!e["~run"]({value:t},{abortEarly:!0}).issues}function U(e){return{kind:"schema",type:"boolean",reference:U,expects:"boolean",async:!1,message:e,get"~standard"(){return v(this)},"~run"(t,r){return typeof t.value=="boolean"?t.typed=!0:g(this,"type",t,r),t}}}function ze(e){return{kind:"schema",type:"date",reference:ze,expects:"Date",async:!1,message:e,get"~standard"(){return v(this)},"~run"(t,r){return t.value instanceof Date?isNaN(t.value)?g(this,"type",t,r,{received:'"Invalid Date"'}):t.typed=!0:g(this,"type",t,r),t}}}function Ge(e,t){return{kind:"schema",type:"instance",reference:Ge,expects:e.name,async:!1,class:e,message:t,get"~standard"(){return v(this)},"~run"(r,n){return r.value instanceof this.class?r.typed=!0:g(this,"type",r,n),r}}}function se(e){return{kind:"schema",type:"lazy",reference:se,expects:"unknown",async:!1,getter:e,get"~standard"(){return v(this)},"~run"(t,r){return this.getter(t.value)["~run"](t,r)}}}function O(e,t){return{kind:"schema",type:"loose_object",reference:O,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return v(this)},"~run"(r,n){var s;const i=r.value;if(i&&typeof i=="object"){r.typed=!0,r.value={};for(const a in this.entries){const o=this.entries[a];if(a in i||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){const u=a in i?i[a]:Je(o),c=o["~run"]({value:u},n);if(c.issues){const p={type:"object",origin:"value",input:i,key:a,value:u};for(const f of c.issues)f.path?f.path.unshift(p):f.path=[p],(s=r.issues)==null||s.push(f);if(r.issues||(r.issues=c.issues),n.abortEarly){r.typed=!1;break}}c.typed||(r.typed=!1),r.value[a]=c.value}else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(g(this,"key",r,n,{input:void 0,expected:`"${a}"`,path:[{type:"object",origin:"key",input:i,key:a,value:i[a]}]}),n.abortEarly))break}if(!r.issues||!n.abortEarly)for(const a in i)De(i,a)&&!(a in this.entries)&&(r.value[a]=i[a])}else g(this,"type",r,n);return r}}}function D(e){return{kind:"schema",type:"number",reference:D,expects:"number",async:!1,message:e,get"~standard"(){return v(this)},"~run"(t,r){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:g(this,"type",t,r),t}}}function h(e,t){return{kind:"schema",type:"optional",reference:h,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return v(this)},"~run"(r,n){return r.value===void 0&&(this.default!==void 0&&(r.value=Je(this,r,n)),r.value===void 0)?(r.typed=!0,r):this.wrapped["~run"](r,n)}}}function Be(e,t,r){return{kind:"schema",type:"record",reference:Be,expects:"Object",async:!1,key:e,value:t,message:r,get"~standard"(){return v(this)},"~run"(n,s){var i,a;const o=n.value;if(o&&typeof o=="object"){n.typed=!0,n.value={};for(const u in o)if(De(o,u)){const c=o[u],p=this.key["~run"]({value:u},s);if(p.issues){const b={type:"object",origin:"key",input:o,key:u,value:c};for(const _ of p.issues)_.path=[b],(i=n.issues)==null||i.push(_);if(n.issues||(n.issues=p.issues),s.abortEarly){n.typed=!1;break}}const f=this.value["~run"]({value:c},s);if(f.issues){const b={type:"object",origin:"value",input:o,key:u,value:c};for(const _ of f.issues)_.path?_.path.unshift(b):_.path=[b],(a=n.issues)==null||a.push(_);if(n.issues||(n.issues=f.issues),s.abortEarly){n.typed=!1;break}}(!p.typed||!f.typed)&&(n.typed=!1),p.typed&&(n.value[p.value]=f.value)}}else g(this,"type",n,s);return n}}}function d(e){return{kind:"schema",type:"string",reference:d,expects:"string",async:!1,message:e,get"~standard"(){return v(this)},"~run"(t,r){return typeof t.value=="string"?t.typed=!0:g(this,"type",t,r),t}}}function Fe(e){let t;if(e)for(const r of e)t?t.push(...r.issues):t=r.issues;return t}function ae(e,t){return{kind:"schema",type:"union",reference:ae,expects:Vt(e.map(r=>r.expects),"|"),async:!1,options:e,message:t,get"~standard"(){return v(this)},"~run"(r,n){let s,i,a;for(const o of this.options){const u=o["~run"]({value:r.value},n);if(u.typed)if(u.issues)i?i.push(u):i=[u];else{s=u;break}else a?a.push(u):a=[u]}if(s)return s;if(i){if(i.length===1)return i[0];g(this,"type",r,n,{issues:Fe(i)}),r.typed=!0}else{if((a==null?void 0:a.length)===1)return a[0];g(this,"type",r,n,{issues:Fe(a)})}return r}}}function He(){return{kind:"schema",type:"unknown",reference:He,expects:"unknown",async:!1,get"~standard"(){return v(this)},"~run"(e){return e.typed=!0,e}}}function Ke(e,t,r){const n=e["~run"]({value:t},We(r));if(n.issues)throw new er(n.issues);return n.value}function j(...e){return{...e[0],pipe:e,get"~standard"(){return v(this)},"~run"(t,r){for(const n of e)if(n.kind!=="metadata"){if(t.issues&&(n.kind==="schema"||n.kind==="transformation")){t.typed=!1;break}(!t.issues||!r.abortEarly&&!r.abortPipeEarly)&&(t=n["~run"](t,r))}return t}}}function rr(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}function nr(e){return Object.entries(e).reduce((t,[r,n])=>(t[rr(r)]=n,t),{})}function ie(e){const t=nr(e);for(const r in t){const n=t[r];n&&typeof n=="object"&&!(n instanceof Date)&&(t[r]=Array.isArray(n)?n.map(ie):ie(n))}return t}function oe(e){return S(t=>e?ie(t):t)}function Ye(e){return t=>j(e,oe(t))}function sr(e){return(t,r)=>Ke(j(e,oe(r)),t)}function ue(){return S(JSON.parse)}function ce(e){const t=Ye(e);return r=>j(d(),ue(),t(r))}function ar(e){return S(t=>{const r={};return new URLSearchParams(t).forEach((n,s)=>{const i=r[s];Array.isArray(i)?i.push(n):i===void 0?r[s]=n:r[s]=[i,n]}),Ke(e,r)})}function Qe(e){return t=>j(ae([d(),Ge(URLSearchParams)]),ar(e),oe(t))}const Ze=h(se(()=>lr())),ir=O({id:D(),photo_url:h(d()),type:d(),title:d(),username:h(d())}),or=O({added_to_attachment_menu:h(U()),allows_write_to_pm:h(U()),first_name:d(),id:D(),is_bot:h(U()),is_premium:h(U()),last_name:h(d()),language_code:h(d()),photo_url:h(d()),username:h(d())}),ur=O({auth_date:j(d(),S(e=>new Date(Number(e)*1e3)),ze()),can_send_after:h(j(d(),S(Number),xe())),chat:h(se(()=>cr())),chat_type:h(d()),chat_instance:h(d()),hash:d(),query_id:h(d()),receiver:Ze,start_param:h(d()),signature:d(),user:Ze}),cr=ce(ir),lr=ce(or),pr=Qe(ur);function fr(e){return/^#[\da-f]{6}$/i.test(e)}const Xe=Ye(Be(d(),j(ae([d(),D()]),S(e=>typeof e=="number"?`#${(e&16777215).toString(16).padStart(6,"0")}`:e),Ne(fr)))),le=h(j(d(),S(e=>e==="1"))),Ve=ce(Xe()),dr=O({tgWebAppBotInline:le,tgWebAppData:h(pr()),tgWebAppDefaultColors:h(Ve()),tgWebAppFullscreen:le,tgWebAppPlatform:d(),tgWebAppShowSettings:le,tgWebAppStartParam:h(d()),tgWebAppThemeParams:Ve(),tgWebAppVersion:d()}),et=Qe(dr),pe=sr(et()),tt=O({eventType:d(),eventData:h(He())});function rt(e,t){return t||(t=(r,n)=>JSON.stringify(n)),new URLSearchParams(Object.entries(e).reduce((r,[n,s])=>(Array.isArray(s)?r.push(...s.map(i=>[n,String(i)])):s!=null&&r.push([n,s instanceof Date?(s.getTime()/1e3|0).toString():typeof s=="string"||typeof s=="number"?String(s):typeof s=="boolean"?s?"1":"0":t(n,s)]),r),[])).toString()}function yr(e){return rt(e)}function hr(e){return rt(e,(t,r)=>t==="tgWebAppData"?yr(r):JSON.stringify(r))}function nt(e){try{return tr(et(),e)}catch{return!1}}function br(e){return{all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map(function(s){s(r)}),(n=e.get("*"))&&n.slice().map(function(s){s(t,r)})}}}function _r(e,t){const r=new Map,n=br(),s=(i,a,o)=>{o||(o=!1);const u=r.get(i)||new Map;r.set(i,u);const c=u.get(a)||[];u.set(a,c);const p=c.findIndex(f=>f[1]===o);if(p>=0&&(n.off(i,c[p][0]),c.splice(p,1),!c.length&&(u.delete(a),!u.size))){const f=r.size;r.delete(i),f&&!r.size&&t()}};return[function(a,o,u){!r.size&&e();const c=()=>{s(a,o,u)},p=(..._)=>{u&&c(),a==="*"?o(_):o(..._)};n.on(a,p);const f=r.get(a)||new Map;r.set(a,f);const b=f.get(o)||[];return f.set(o,b),b.push([p,u||!1]),c},s,n.emit,function(){const a=r.size;n.all.clear(),r.clear(),a&&t()}]}function N(e,t){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:e,eventData:t}),source:window.parent}))}function mr(e,t){t()}function fe(e,t){t||(t={});const r=t.equals||Object.is;let n=[],s=e;const i=c=>{if(!r(s,c)){const p=s;s=c,mr(u,()=>{[...n].forEach(([f,b])=>{f(c,p),b&&o(f,!0)})})}};function a(c){const p=typeof c!="object"?{once:c}:c;return{once:p.once||!1,signal:p.signal||!1}}const o=(c,p)=>{const f=a(p),b=n.findIndex(([_,A])=>_===c&&A.once===f.once&&A.signal===f.signal);b>=0&&n.splice(b,1)},u=Object.assign(function(){return gr(u),s},{destroy(){n=[]},set:i,reset(){i(e)},sub(c,p){return n.push([c,a(p)]),()=>o(c,p)},unsub:o,unsubAll(){n=n.filter(c=>c[1].signal)}});return u}const de=[];function gr(e){de.length&&de[de.length-1].add(e)}let x=!1;const st=e=>{P().log("Event received:",e)};function at(e){e!==x&&(x=e,x?he("*",st):lt("*",st))}const P=fe(Ue("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog(){return x}}));function it(e,t,r,n){Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:r,set:n})}function ot(e,t){const r=e[t];it(e,t,()=>r,n=>{Object.entries(n).forEach(([s,i])=>{r[s]=i})})}function ut(e,t,r){Object.defineProperty(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r})}function ye(e,t,r){const n=e[t],s=[r];typeof n=="function"&&s.push(n);const i=(...o)=>{s.forEach(u=>{u(...o)})},a=Object.assign((...o)=>{i(...o)},{unwrap(){const{length:o}=s;if(o===1){delete e[t];return}if(o===2){ut(e,t,s[1]);return}s.unshift(1),ut(e,t,i)}});it(e,t,()=>a,o=>{s.push(o)})}const vr={clipboard_text_received:w({req_id:$(),data:C($())}),custom_method_invoked:w({req_id:$(),result:X(Se()),error:X($())}),popup_closed:C(w({button_id:C($(),()=>{})}),{}),viewport_changed:w({height:Z(),width:C(Z(),()=>window.innerWidth),is_state_stable:Y(),is_expanded:Y()}),theme_changed:w({theme_params:Xe()})};function ct(e){if(e.source!==window.parent)return;let t;try{t=V(je($(),ue(),tt),e.data)}catch{return}const{eventType:r,eventData:n}=t,s=vr[r];let i;try{i=s?V(s,n):n}catch(a){return P().forceError([`An error occurred processing the "${r}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),t,a)}wr(r,i)}const[he,lt,wr,pt]=_r(()=>{const e=window;!e.TelegramGameProxy&&(e.TelegramGameProxy={}),ye(e.TelegramGameProxy,"receiveEvent",N),ot(e,"TelegramGameProxy"),!e.Telegram&&(e.Telegram={}),!e.Telegram.WebView&&(e.Telegram.WebView={}),ye(e.Telegram.WebView,"receiveEvent",N),ot(e.Telegram,"WebView"),ye(e,"TelegramGameProxy_receiveEvent",N),window.addEventListener("message",ct)},()=>{[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(e=>{const t=window;let r=[void 0,t];for(const i of e)if(r=[r[1],r[1][i]],!r[1])return;const[n,s]=r;"unwrap"in s&&(s.unwrap(),n&&n!==t&&!Object.keys(n).length&&delete t[e[0]])}),window.removeEventListener("message",ct)});var Er=Object.defineProperty,kr=(e,t,r)=>t in e?Er(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,be=(e,t,r)=>kr(e,typeof t!="symbol"?t+"":t,r);function ft(e,t){return r=>r instanceof e&&r.type===t}function I(e,t){t||(t=[]);const r=Symbol(e);class n extends Error{constructor(...i){const a=typeof t=="function"?t(...i):typeof t=="string"?[t]:t||[];super(...a),be(this,"type",r),this.name=e}}return Object.defineProperty(n,"name",{value:e}),[n,ft(n,r)]}function Pr(e,t,r){const n=Symbol(e);class s extends I(e,r)[0]{constructor(...a){super(...a),be(this,"data"),be(this,"type",n),this.data=t(...a)}}return Object.defineProperty(s,"name",{value:e}),[s,ft(s,n)]}const[dt,$r]=I("MethodUnsupportedError",(e,t)=>[`Method "${e}" is unsupported in Mini Apps version ${t}`]),[yt,Sr]=I("MethodParameterUnsupportedError",(e,t,r)=>[`Parameter "${t}" of "${e}" method is unsupported in Mini Apps version ${r}`]),[ht,jr]=Pr("LaunchParamsRetrieveError",e=>({errors:e}),e=>[["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","ðŸ“– Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment","","Collected errors:",...e.map(([t,r])=>`Source: ${t} / ${r instanceof Error?r.message:String(r)}`)].join(`
`)]),[bt,Ar]=I("InvalidLaunchParamsError",(e,t)=>[`Invalid value for launch params: ${e}`,{cause:t}]),[_t,Tr]=I("UnknownEnvError"),[mt,Mr]=I("InvokeCustomMethodError",e=>[`Server returned error: ${e}`]),q=fe((...e)=>{try{window.parent.postMessage(...e)}catch(t){t instanceof SyntaxError?P().forceError("Unable to call window.parent.postMessage due to incorrectly configured target origin. Use the setTargetOrigin method to allow this origin to receive events",t):P().forceError(t)}}),gt=(...e)=>q()(...e),J=fe("https://web.telegram.org");function Or(e){J.set(e),P().log("New target origin set",e)}function _e(e,t){P().log("Posting event:",t?{eventType:e,eventData:t}:{eventType:e});const r=window,n=JSON.stringify({eventType:e,eventData:t});if(te())return gt(n,J());if(ee(r)){r.TelegramWebviewProxy.postEvent(e,JSON.stringify(t));return}if(W(w({external:w({notify:Q()})}),r)){r.external.notify(n);return}throw new _t}function me(e,t,r){r||(r={});const{capture:n}=r,[s,i]=Qt();return new T(a=>{(Array.isArray(t)?t:[t]).forEach(o=>{s(he(o,u=>{(!n||(Array.isArray(t)?n({event:o,payload:u}):n(u)))&&a(u)}))}),(r.postEvent||_e)(e,r.params)},r).finally(i)}const vt="launchParams";function wt(e){return e.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&")}function ge(){const e=[];for(const[t,r]of[[()=>wt(window.location.href),"window.location.href"],[()=>{const n=performance.getEntriesByType("navigation")[0];return n&&wt(n.name)},"performance navigation entries"],[()=>Yt(vt),"local storage"]]){const n=t();if(!n){e.push([r,new Error("Source is empty")]);continue}if(nt(n))return Ce(vt,n),n;try{pe(n)}catch(s){e.push([r,s])}}throw new ht(e)}function Et(e){const t=pe(ge());return e?ne(t):t}function Ir(e,t){if(!e)try{return Et(),!0}catch{return!1}return T.fn(async r=>{if(ee(window))return!0;try{return await me("web_app_request_theme","theme_changed",r),!0}catch{return!1}},t||{timeout:100})}function qr({launchParams:e,onEvent:t,resetPostMessage:r}={}){if(e){const i=typeof e=="string"||e instanceof URLSearchParams?e.toString():hr({...e,tgWebAppData:void 0})+(e.tgWebAppData?`&tgWebAppData=${encodeURIComponent(e.tgWebAppData.toString())}`:"");if(!nt(i))try{pe(i)}catch(a){throw new bt(i,a)}Ce("launchParams",i)}if(te()){if(!t)return;const i=je($(),ue(),tt);r&&q.reset();const a=q();q.set((...o)=>{const[u]=o,c=()=>{a(...o)};if(W(i,u)){const p=V(i,u);t([p.eventType,p.eventData],c)}else c()});return}const n=window.TelegramWebviewProxy||{},s=n.postEvent||(()=>{});window.TelegramWebviewProxy={...n,postEvent(i,a){const o=()=>{s(i,a)};t?t([i,a?JSON.parse(a):void 0],o):o()}},P().log("Environment was mocked by the mockTelegramEnv function")}function Lr(){return new URLSearchParams(ge()).get("tgWebAppData")||void 0}function kt(e){return({req_id:t})=>t===e}function Pt(e){return e.split(".").map(Number)}function $t(e,t){const r=Pt(e),n=Pt(t),s=Math.max(r.length,n.length);for(let i=0;i<s;i+=1){const a=r[i]||0,o=n[i]||0;if(a!==o)return a>o?1:-1}return 0}function m(e,t){return $t(e,t)<=0}function ve(e,t,r){if(typeof r=="string"){if(e==="web_app_open_link"){if(t==="try_instant_view")return m("6.4",r);if(t==="try_browser")return m("7.6",r)}if(e==="web_app_set_header_color"&&t==="color")return m("6.9",r);if(e==="web_app_close"&&t==="return_back")return m("7.6",r);if(e==="web_app_setup_main_button"&&t==="has_shine_effect")return m("7.10",r)}switch(e){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return m("6.1",t);case"web_app_open_popup":return m("6.2",t);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return m("6.4",t);case"web_app_switch_inline_query":return m("6.7",t);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return m("6.9",t);case"web_app_setup_settings_button":return m("6.10",t);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return m("7.2",t);case"web_app_setup_swipe_behavior":return m("7.7",t);case"web_app_share_to_story":return m("7.8",t);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return m("7.10",t);case"web_app_request_safe_area":case"web_app_request_content_safe_area":case"web_app_request_fullscreen":case"web_app_exit_fullscreen":case"web_app_set_emoji_status":case"web_app_add_to_home_screen":case"web_app_check_home_screen":case"web_app_request_emoji_status_access":case"web_app_check_location":case"web_app_open_location_settings":case"web_app_request_file_download":case"web_app_request_location":case"web_app_send_prepared_message":case"web_app_start_accelerometer":case"web_app_start_device_orientation":case"web_app_start_gyroscope":case"web_app_stop_accelerometer":case"web_app_stop_device_orientation":case"web_app_stop_gyroscope":case"web_app_toggle_orientation_lock":return m("8.0",t);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(e)}}function Rr(e,t){t||(t="strict");const r=typeof t=="function"?t:n=>{const{method:s,version:i}=n,a="param"in n?new yt(s,n.param,i):new dt(s,i);if(t==="strict")throw a;return P().forceWarn(a.message)};return(n,s)=>ve(n,e)?n==="web_app_set_header_color"&&W(w({color:$e()}),s)&&!ve(n,"color",e)?r({version:e,method:n,param:"color"}):_e(n,s):r({version:e,method:n})}function Cr(e){const t=G(typeof e=="string"?e:JSON.stringify(e));if(t.length>512)throw new Error("Value is too long for start parameter");return t}function Ur(e,t){const r=ke(e);return t==="json"?JSON.parse(r):t?t(r):r}function Wr(e){return G(e).length<=512}function Dr(e,t,r,n){return me("web_app_invoke_custom_method","custom_method_invoked",{...n||{},params:{method:e,params:t,req_id:r},capture:kt(r)}).then(({result:s,error:i})=>{if(i)throw new mt(i);return s})}function Nr(){Object.hasOwn||(Object.hasOwn=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)})}function xr(){pt(),at(!1),[q,J].forEach(e=>{e.unsubAll(),e.reset()})}return l.AbortablePromise=T,l.CancelledError=Te,l.InvalidLaunchParamsError=bt,l.InvokeCustomMethodError=mt,l.LaunchParamsRetrieveError=ht,l.ManualPromise=Ft,l.MethodParameterUnsupportedError=yt,l.MethodUnsupportedError=dt,l.TimeoutError=Me,l.UnknownEnvError=_t,l.applyPolyfills=Nr,l.captureSameReq=kt,l.compareVersions=$t,l.createLogger=Ue,l.createPostEvent=Rr,l.createStartParam=Cr,l.decodeBase64Url=ke,l.decodeStartParam=Ur,l.emitEvent=N,l.encodeBase64Url=G,l.hasWebviewProxy=ee,l.invokeCustomMethod=Dr,l.isCancelledError=zt,l.isIframe=te,l.isInvalidLaunchParamsError=Ar,l.isInvokeCustomMethodError=Mr,l.isLaunchParamsRetrieveError=jr,l.isMethodMethodParameterUnsupportedError=Sr,l.isMethodUnsupportedError=$r,l.isSafeToCreateStartParam=Wr,l.isTMA=Ir,l.isTimeoutError=Gt,l.isUnknownEnvError=Tr,l.logger=P,l.mockTelegramEnv=qr,l.off=lt,l.offAll=pt,l.on=he,l.postEvent=_e,l.postMessage=gt,l.postMessageImplementation=q,l.request=me,l.resetPackageState=xr,l.retrieveLaunchParams=Et,l.retrieveRawInitData=Lr,l.retrieveRawLaunchParams=ge,l.setDebug=at,l.setTargetOrigin=Or,l.supports=ve,l.targetOrigin=J,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),l}({});
//# sourceMappingURL=index.iife.js.map
